<div class="dashboard-container">

  <h1 class="section-header w-full">Contactos</h1>

  <input class="input input--search w-full" type="search" placeholder="Busca un contacto"/>

  <!-- Alterna entre mostrar el botÃ³n de agregar y el formulario -->
  <div id="add-contact-button">
    <a href="#" class="h-auto flex align-self-start lightGrayBG border-radius-small justify-center spacing-m gap-m" onclick="showAddContactForm(); return false;">
      <div class="btn btn--orangeBG border-radius-small">
        <div class="flex justify-center items-center spacing-s">
          <img src="/assets/icons/plusSign.svg" class="icon-s">
        </div>
      </div>
      <div class="flex justify-center items-center text-primary font-semibold text-l">Nuevo contacto</div>
    </a>
  </div>

  <!-- Agregar contacto (escondido por defecto) -->
  <div id="add-contact-form" style="display: none;" class="lightGrayBG border-radius-small spacing-m">
    <form action="/dashboard/contactos" method="POST">
      <div class="form-field">
        <label for="contact_identifier">CVU o Alias del contacto:</label>
        <input type="text" id="contact_identifier" name="contact_identifier" 
               placeholder="Ingresa CVU o alias" 
               class="input w-full" required>
      </div>
      <div class="flex gap-s">
        <button type="submit" class="btn btn--orangeBG">Agregar Contacto</button>
        <button type="button" class="btn btn--secondary" onclick="hideAddContactForm()">Cancelar</button>
      </div>
    </form>
  </div>

 <div class="list list--scrollable" style="max-height: 400px;">
    <% contacts = current_account.contact_list.accounts %>

  <% contacts.each do |contact| %>
      <div class="list-item flex justify-between items-center">

        <a href="#" class="persona">
          <div class="persona__avatar">
            <img src="/assets/defaultAvatar.svg" alt="Avatar" class="avatar avatar--s" />
          </div>
          <div class="persona__datosPersona">
            <div class="name"><%= "#{contact.user.first_name} #{contact.user.last_name}" %></div>
            <div class="email"><%= contact.user.email %></div>
            <div class="email"><%= contact.alias %></div>
            <div class="email"><%= contact.cvu %></div>
          </div>
        </a>

        <div class="favorite-star">
          <% if contact[:favorite] %>
            <img src="/assets/icons/star-yellow.svg" alt="Favorito" class="icon-star" />
          <% else %>
            <img src="/assets/icons/star-outline.svg" alt="No favorito" class="icon-star" />
          <% end %>
        </div>
      </div>
    <% end %>
  </div>
</div>

<script>
function showAddContactForm() {
  document.getElementById('add-contact-button').style.display = 'none';
  document.getElementById('add-contact-form').style.display = 'block';
  document.getElementById('contact_identifier').focus();
}

function hideAddContactForm() {
  document.getElementById('add-contact-form').style.display = 'none';
  document.getElementById('add-contact-button').style.display = 'block';
}
</script>
